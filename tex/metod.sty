% -*-coding: utf-8 -*-

\usepackage[russian]{babel}
\usepackage[UTF8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[paper = a4paper, left = 2cm, right = 2cm, top = 3cm, bottom = 2cm]{geometry}

% расстояния между номером и названием раздела
\usepackage{titlesec}
\titleformat{\section}
  {\normalfont\Large\bfseries}{\thesection}{0.5em}{}
\titleformat{\subsection}
  {\normalfont\large\bfseries}{\thesubsection}{0.5em}{}
\titleformat{\subsubsection}
  {\normalfont\bfseries}{\thesubsubsection}{0.3em}{}

\usepackage{amstext} % Для формул
\usepackage{amsmath} % Для формул
\usepackage{amssymb} % Для формул

\usepackage{enumitem} % Поменьше расстояния между itemами
\setlist[itemize]{topsep = 3 pt, itemsep = 1 pt, parsep = 2 pt,
    partopsep = 3pt, after = \vspace{3pt}}
\setlist[enumerate]{topsep = 3 pt, itemsep = 1 pt, parsep = 2 pt,
    partopsep = 3pt, after = \vspace{3pt}}


\usepackage{icomma} % Десятичная запятая вместо точки
\usepackage{graphicx} % Вставка рисунков
\usepackage{url} % Внедрение ссылок в PDF
\usepackage{dtklogos} % Разные логотипы (MiKTeX в частности)
\usepackage{indentfirst}
\usepackage{array} % Таблички

\usepackage{multirow}

\usepackage{textcomp}
\usepackage{moresize}

\usepackage{ccaption}
%\usepackage[nooneline]{caption}
\addto\captionsrussian{ \def\figurename{Рис.} }   % Дина - ГОСТ: 1 - 0
\addto\captionsrussian{ \def\tablename{Таблица} } % Но в остальном ГОСТ
                                                  % вяло обороняется
\captiondelim{~---~}
\captionstyle{\centering}
\captionwidth{0.8\linewidth}
\changecaptionwidth


%%% Убираем точки после цифр в заголовках
\def\russian@capsformat{%
  \def\postchapter{\@aftersepkern}%
  \def\postsection{\@aftersepkern}%
  \def\postsubsection{\@aftersepkern}%
  \def\postsubsubsection{\@aftersepkern}%
  \def\postparagraph{\@aftersepkern}%
  \def\postsubparagraph{\@aftersepkern}%
}

%\let\stdsection\section
%\renewcommand\section{\newpage\stdsection} % Разделы с новых страниц


%\numberwithin{equation}{section}


\usepackage{chngcntr}
% Во введении (а введение - это section с номером -1) - формулы нумеруются так: (Вэ.N), дальше (M.N).
\counterwithin{equation}{section} % Чтобы N сбрасывалась на смене section
\counterwithin{table}{section} % Чтобы N сбрасывалась на смене section
\counterwithin{figure}{section} % Чтобы N сбрасывалась на смене section

% Пришлось сменить на -1, потому что эти ребята брутальные,
% и у них есть не только введение, но и нулевая лабораторная работа

\renewcommand{\theequation}{\ifnum\c@section=-1{В.\arabic{equation}}\else{\arabic{section}.\arabic{equation}}\fi}
% Чувствую себя 1337 TeX-программистом.

% Таблицы
\renewcommand{\thetable}{\ifnum\c@section=-1{В.\arabic{table}}\else{\arabic{section}.\arabic{table}}\fi}
% Картинки
\renewcommand{\thefigure}{\ifnum\c@section=-1{В.\arabic{figure}}\else{\arabic{section}.\arabic{figure}}\fi}

\renewcommand\thesubsection{\ifnum\c@section=-1{В.\arabic{subsection}}\else{\arabic{section}.\arabic{subsection}}\fi} % Во "введениях" нумерация подразделов через В. 1, В. 2


% Команды оформления титульников
\newcommand{\VMTDAuthors}{<Авторы/составители>}
\newcommand{\VMTDEditorsGenetiveCase}{<Редакторы в родительном падеже>}

\newcommand{\VMTDLyceum}{Специализированный учебно-научный центр\\Лицей \textnumero 1580 при МГТУ им.~Н.~Э.~Баумана}
\newcommand{\VMTDLyceumS}{Лицей \textnumero 1580 при МГТУ им.~Н.~Э.~Баумана}
\newcommand{\VMTDUni}{Московский государственный  технический университет имени~Н.~Э.~Баумана}
\newcommand{\VMTDDept}{Кафедра <<Основы физики>>}

\newcommand{\VMTDGlobalName}{Лабораторный практикум по физике}
\newcommand{\VMTDPhysSection}{\MakeUppercase{MTDSetPhysSection}}
\newcommand{\VMTDTitle}{MTDSetTitle}
\newcommand{\VMTDGrade}{MTDSetGrade}
\newcommand{\VMTDLabDesignator}{MTDDesignator}


\newcommand{\VMTDYear}{2013}

\newcommand{\MTDSetAuthors}[1]{\renewcommand{\VMTDAuthors}{#1}}
\newcommand{\MTDSetEditorsGenCase}[1]{\renewcommand{\VMTDEditorsGenetiveCase}{#1}}

\newcommand{\MTDSetTitle}[1]{\renewcommand{\VMTDTitle}{#1}}
\newcommand{\MTDSetPhysSection}[1]{\renewcommand{\VMTDPhysSection}{#1}}
\newcommand{\MTDSetGrade}[1]{\renewcommand{\VMTDGrade}{#1}}
\newcommand{\MTDDesignator}[1]{\renewcommand{\VMTDLabDesignator}{#1}}


% прочее

% кидание красивых ворнингов
\newcommand{\MTDWarn}[1]{
\vspace{0.75cm}
\noindent
\begin{tabular}{ >{\centering\arraybackslash} m{0.1\textwidth} >{\centering\arraybackslash} m{0.85\textwidth} }
\hline \hline
\vphantom{\tiny 1}\ {\HUGE !}  & \normalsize \textbf{#1} \\
\hline \hline
\end{tabular}
\vspace{0.75cm}\newline
}


% среднее
\newcommand{\MTDMean}[1]{\ensuremath{\hspace{-3pt}\left<#1\right}>\hspace{-3pt}}

% единицы измерения
\newcommand{\Units}[1]{\hspace{-1pt}#1} % очень точно

% Титульник
\newcommand{\MTDTitlePage}{
 \thispagestyle{empty} % Почему-то titlepage
 \begin{center}        % не считается в счёттике страниц???
  \large \VMTDUni \\ \vspace{0.5cm}
  \VMTDLyceum \\
  \vspace{0.5cm}
  \VMTDDept\\
  \vspace{3cm}
  \LARGE \VMTDGlobalName \\ Электронное издание \\ \LARGE \VMTDGrade\ класс \\ \vspace{1.25cm}
  \Huge \MakeUppercase{\VMTDPhysSection} \\ \vspace{1.5cm} \
  \LARGE Лабораторная работа \fbox{\VMTDLabDesignator} \\
  \huge \VMTDTitle
  \vfill
  \Large Москва, \VMTDYear
 \end{center}
 \newpage
}


% аннотация/первый форзац
\usepackage[strict]{changepage} % Черт, а что он делает? Зачем я его включил? D:
\newcommand{\MTDInfoPage}{
 \thispagestyle{empty}
  \begin{adjustwidth}{2cm}{2cm}
    \phantom{1}
    \vspace{8cm}
    \hspace{0.3cm} \VMTDGlobalName. \VMTDPhysSection. --- \VMTDUni
    \vspace{0.5cm}

    Лабораторный практикум по физике для \VMTDGrade\ класса состоит из лабораторных
    работ для занятий учащихся \VMTDGrade\ классов в Специализированном учебно-научном
    центре МГТУ имени Н.~Э.~Баумана.

    Лабораторные работы, приведенные в сборнике, позволят учащимся глубже изучить
    законы физики и получить навыки проведения экспериментальных физических исследований.

   \vfill
   \centering
   \noindent Составители лабораторных работ: \\
   \begin{tabular}{>{\centering\arraybackslash} m{0.9\linewidth}}
   \hyphenpenalty = 10000
   \VMTDAuthors. \\
   \end{tabular}
   \vspace{1cm}

   \noindent Под редакцией \VMTDEditorsGenetiveCase.

   \vspace{5cm}
   \raggedleft
   \begin{tabular}{p{0.3cm}p{12cm}}
   \hyphenpenalty = 10000
   \textcopyright\ & \VMTDUni, 2013        \\
   \textcopyright\ & \VMTDLyceumS, 2013      \\
   \end{tabular}
  \end{adjustwidth}
 \newpage
}

\renewcommand{\vec}[1]{\ensuremath{\mathbf{#1}}}

\renewcommand{\epsilon}{\varepsilon} % Всё равно первый очень уродливый и никому не нужен.

% Цетрированные ячейки по V и H
%\usepackage{dcolumn}
%\newcolumntype{ctd}[1]{ > {\centering\arraybackslash} m{#1}}
% пока у меня не получается заставить их работать --- пока не жмёт,
% пусть будут закомменченными - Г

\graphicspath{ {../figures/} }
\DeclareGraphicsExtensions{.pdf, .png, .jpg}
%

% Настройки колонтитулов
\usepackage{fancyhdr}
\pagestyle{fancy}

\lhead{} % ЛВ - пустой
\renewcommand{\headrulewidth}{0pt} % Толщина линии, по вкусу
\chead{\emph{\rightmark}} % центральный - это то, что LaTeX
                        % по умолчанию лепит в правые страницы
\rhead{\thepage}
\cfoot{}
\renewcommand{\subsectionmark}[1]{\markright{\thesubsection\ #1}}
% эта магия
% почему-то
% задаёт, как
% сабсекшн выглядит в
% колонтитуле
% Видимо, там как-то так
